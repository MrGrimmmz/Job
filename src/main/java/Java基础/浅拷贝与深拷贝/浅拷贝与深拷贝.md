###浅拷贝与深拷贝
[Java 浅拷贝和深拷贝的理解和实现方式](https://www.cnblogs.com/shakinghead/p/7651502.html)


###Java中的对象拷贝(Object Copy)指的是将一个对象的所有属性（成员变量）拷贝到另一个有着相同类类型的对象中去。
- 举例说明：比如，对象A和对象B都属于类S，具有属性a和b。那么对对象A进行拷贝操作赋值给对象B就是：B.a=A.a;  B.b=A.b;

###Java中的对象拷贝主要分为：浅拷贝(Shallow Copy)、深拷贝(Deep Copy)。

###浅拷贝（Shallow Copy）
- ①对于数据类型是基本数据类型的成员变量，浅拷贝会直接进行值传递，
也就是将该属性值复制一份给新的对象。因为是两份不同的数据，
所以对其中一个对象的该成员变量值进行修改，不会影响另一个对象拷贝得到的数据。

- ②对于数据类型是引用数据类型的成员变量，比如说成员变量是某个数组、
某个类的对象等，那么浅拷贝会进行引用传递，也就是只是将该成员变量的引用值
（内存地址）复制一份给新的对象。因为实际上两个对象的该成员变量都指向同一个实例。
在这种情况下，在一个对象中修改该成员变量会影响到另一个对象的该成员变量值。

###浅拷贝的实现方式主要有：
- 一、通过拷贝构造方法实现浅拷贝：
    - 拷贝构造方法指的是该类的构造方法参数为该类的对象。使用拷贝构造方法可以很好地完成浅拷贝，直接通过一个现有的对象创建出与该对象属性相同的新的对象。
```aidl
/* 拷贝构造方法实现浅拷贝 */
public class CopyConstructor {
    public static void main(String[] args) {
        Person p1=new Person(20,"摇头耶稣");
        Person p2=new Person(p1);
        System.out.println(p2);
    }
}
class Person{
    private int age;
    private String name;
    public Person(int age,String name) {
        this.age=age;
        this.name=name;
    }
    public Person(Person p) {
        this.name=p.name;
        this.age=p.age;
    }
        //声明拷贝构造方法，方法体中将所有属性都进行赋值
    public String toString() {
        return this.name+this.age;
    }
}

运行结果为：

摇头耶稣20
```  
- 二、通过重写clone()方法进行浅拷贝：
    - Object类是类结构的根类，其中有一个方法为protected Object clone() throws CloneNotSupportedException，这个方法就是进行的浅拷贝。有了这个浅拷贝模板，我们可以通过调用clone()方法来实现对象的浅拷贝。但是需要注意：1、Object类虽然有这个方法，但是这个方法是受保护的（被protected修饰），所以我们无法直接使用。2、使用clone方法的类必须实现Cloneable接口，否则会抛出异常CloneNotSupportedException。对于这两点，我们的解决方法是，在要使用clone方法的类中重写clone()方法，通过super.clone()调用Object类中的原clone方法。


###深拷贝
- 首先介绍对象图的概念。设想一下，一个类有一个对象，
其成员变量中又有一个对象，该对象指向另一个对象，
另一个对象又指向另一个对象，直到一个确定的实例。这就形成了对象图。

- 那么，对于深拷贝来说，不仅要复制对象的所有基本数据类型的成员变量值，还要为所有引用数据类型的成员变量申请存储空间，并复制每个引用数据类型成员变量所引用的对象，直到该对象可达的所有对象。也就是说，对象进行深拷贝要对整个对象图进行拷贝！

- 简单地说，深拷贝对引用数据类型的成员变量的对象图中所有的对象都开辟了内存空间；而浅拷贝只是传递地址指向，新的对象并没有对引用数据类型创建内存空间。
   
- 因为创建内存空间和拷贝整个对象图，所以深拷贝相比于浅拷贝速度较慢并且花销较大。

###深拷贝的实现方法主要有两种：
- 一、通过重写clone方法来实现深拷贝
    - 进行了深拷贝之后，无论是什么类型的属性值的修改，都不会影响另一个对象的属性值。

- 二、通过对象序列化实现深拷贝
    - 虽然层次调用clone方法可以实现深拷贝，但是显然代码量实在太大。特别对于属性数量比较多、层次比较深的类而言，每个类都要重写clone方法太过繁琐。
    - 将对象序列化为字节序列后，默认会将该对象的整个对象图进行序列化，再通过反序列即可完美地实现深拷贝。
    